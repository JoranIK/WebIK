{% extends "layout.html" %}

{% block title %}
    Search
{% endblock %}

{% block main %}
<body>
  <h1 class="display-5">Results that match your search:</h1>
  <ul class="list-group">
    {% for username, id in results.items() %}
    <form action="/follow?username={{ username }}" method="GET">
      <div class="form-group">
        <li class="list-group-item d-flex justify-content-between align-items-center">
          {{ username }}
          <input type="hidden" name="user_id" value="{{ id }}"></input>
          {% if session.user_id %}
            {% if id in already_following %}
              <button class="btn btn-success" type="submit" name="id">Following</button>
            {% else %}
              <button class="btn btn-info" type="submit" name="id">Follow</button>
            {% endif %}
          {% endif %}
        </li>
      </div>
    </form>
    {% endfor %}
  </ul>
</body>

<script type="text/javascript">
(function() {
      'use strict';
      window.addEventListener('load', function() {
        document.querySelectorAll('.btn').forEach(button => {
          button.addEventListener('click', event => {
            if(button.innerHTML === 'Follow') {
              button.classList.remove('btn-info')
              button.classList.add('btn-success')
              button.innerHTML = 'Following'
            }
          })
        })
      }, false);
    })();
</script>

{% endblock %}
